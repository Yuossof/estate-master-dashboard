import{j as e,I as k,P as D,u as A,r as a,C as V,i as E,k as T,Q as B}from"./index-DSdmN7-O.js";import{a as H,c as Q}from"./options-OSOtnHuq.js";const q=({optionData:x,setOptionData:m,handleSubmit:f,errors:c,setErrors:p,isLoading:y})=>{const i=g=>{const{name:d,value:u}=g.target;p(r=>({...r,[d]:""})),m(r=>({...r,[d]:u}))};return e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-col min-w-[150px]",children:[e.jsx("label",{htmlFor:"name",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Name"}),e.jsx(k,{type:"text",placeholder:"Item Value",name:"item_value",id:"item_value",value:x.item_value,onChange:i}),c.item_key&&e.jsxs("p",{className:"text-[13px] text-red-500 mt-2 ml-1",children:["*",c.item_key[0]]})]}),e.jsxs("div",{className:"flex flex-col min-w-[150px]",children:[e.jsx("label",{htmlFor:"item_value_ar",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Name Arabic"}),e.jsx(k,{type:"text",placeholder:"Item Value Arabic",name:"item_value_ar",id:"item_value_ar",value:x.item_value_ar,onChange:i}),c.item_value_ar&&e.jsxs("p",{className:"text-[13px] text-red-500 mt-2 ml-1",children:["*",c.item_value_ar[0]]})]})]})}),e.jsx("div",{className:"mt-6 flex w-full md:justify-end",children:e.jsxs("button",{disabled:y,style:{opacity:y?"0.6":"1"},type:"button",className:"btn-primary flex items-center gap-3 justify-center h-10 px-3 rounded-md md:w-auto w-full",onClick:f,children:[e.jsx("span",{children:"Create"}),e.jsx(D,{})]})})]})},z={item_key:"",item_value:"",item_value_ar:""},U=()=>{const x=A(),[m,f]=a.useState(z),[c,p]=a.useState(!1),[y,i]=a.useState({}),[g,d]=a.useState([]),[u,r]=a.useState(!0),[S,h]=a.useState(!1),[v,_]=a.useState(1),[C,K]=a.useState({}),[j,F]=a.useState(""),[N,R]=a.useState(""),[I,P]=a.useState([]),[b,O]=a.useState(null),w=a.useRef(null);a.useEffect(()=>{(async()=>{if(u)try{h(!0);const s=await T(7,v,N),n=s.data.items||[];n.length===0&&r(!1),v>=s.data.pagination.totalPages&&r(!1),d(o=>[...o,...n.map(l=>({id:l.id,name:l.name}))])}catch(s){console.log(s)}finally{h(!1)}})()},[v,N]),a.useEffect(()=>{(async()=>{if(u)try{h(!0);const n=(await H()).data.keys||[];P(o=>[...o,...n.map(l=>({id:l,name:l}))])}catch(s){console.log(s)}})()},[]),a.useEffect(()=>{const t=setTimeout(()=>{R(j)},350);return()=>{clearTimeout(t)}},[j]),a.useEffect(()=>{_(1),d([]),r(!0)},[N]);const L=()=>{u&&_(t=>t+1)},M=async()=>{try{const t=new FormData;try{t.append("company_id",C.id),t.append("item_key",b.name),t.append("item_value",m.name),t.append("item_value_ar",m.name_ar),i({})}catch(n){if(console.log("Validation error:",n),n.inner){const o={};n.inner.forEach(l=>{o[l.path]=l.message}),console.log("Parsed errors:",o),i(o)}return}p(!0);const s=await Q(t);B.success(s.message||s.massage),x("/options")}catch(t){console.log("Error in handleSubmit:",t)}finally{p(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(V,{children:[e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-100 dark:border-[var(--border-secondary)]",children:[e.jsx("h1",{className:"md:text-2xl text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Create Option"}),e.jsx("p",{className:"md:text-base text-[14px] text-gray-500 dark:text-gray-400 mt-1",children:"Add a new option"})]}),e.jsx("div",{className:"flex w-full md:items-center sm:items-end items-center mb-8 md:flex-row flex-col",children:e.jsxs("div",{className:"flex items-center gap-2 flex-1 md:flex-row flex-col md:w-auto w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"clientName",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Company"}),e.jsx(E,{searchKeySelect:j,onInputChange:t=>F(t),onChange:t=>K(t),onEndReached:L,options:g,value:C.name,isLoading:S,optionBoxRef:w,noResultMessage:"No result"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"clientName",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Key"}),e.jsx(E,{onChange:t=>O(t),options:I,value:b?.name,isLoading:S,optionBoxRef:w,noResultMessage:"No result"})]})]})}),e.jsx(q,{optionData:m,setOptionData:f,errors:y,setErrors:i,handleSubmit:M,isLoading:c})]})})};export{U as default};
