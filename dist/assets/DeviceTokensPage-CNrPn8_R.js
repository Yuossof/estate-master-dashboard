import{O as M,H as $,J as V,K as q,u as B,r as a,j as e,w as H,v as G,M as k,S as J,T as W,x as Q,C as X,i as Y,y as Z,F as ee,z as te,G as ae,a5 as se}from"./index-DSdmN7-O.js";import{d as re}from"./options-OSOtnHuq.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m12 15 2 2 4-4",key:"2c609p"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ne=M("copy-check",le),ie=async(c,n,m,h,o)=>{try{const i=$("token");return i?(await V.get(`/api/dashboard/device-tokens?user_id=${m}&item_key=${h}&q=${o}&per_page=${c}&page=${n}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}})).data:void 0}catch(i){q(i)}},ce=c=>{navigator.clipboard.writeText(c)},de=({columns:c,deviceTokensRows:n=[],setDeviceTokensRows:m,setRefetch:h,refetch:o})=>{const i=B(),[x,u]=a.useState(!1),[g,p]=a.useState(null),[f,y]=a.useState(!1),[N,j]=a.useState(!1),[d,v]=a.useState({id:"",bool:!1}),S=(t,r)=>{ce(t),v({id:r,bool:!0}),setTimeout(()=>{v({id:"",bool:!1})},1e3)},_=async()=>{try{y(!0);const t=await re(g);u(!1);const r=n.filter(b=>b.id!==g);m(r),r.length===0&&h(!o),console.log(t)}catch(t){console.log(t)}finally{y(!1)}},C=t=>{i("/options/edit",{state:{rowData:t}})};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onConfirm:_,onCancel:()=>u(!1),isOpen:x,message:"Are you sure you want to delete this item?",confirmText:"Delete",cancelText:"Cancel",isLoading:f}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)]",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsx("tr",{children:c.map((t,r)=>e.jsx("th",{scope:"col",className:"table-th",children:t.label},r))})}),e.jsx("tbody",{className:"bg-white dark:bg-transparent divide-y divide-gray-100 dark:divide-[var(--border-secondary)]",children:n.length>0&&n.map((t,r)=>e.jsxs("tr",{className:`align-top ${r%2!==0?"bg-gray-50/50 dark:bg-[var(--surface-elevated)]/30":"bg-white dark:bg-transparent"}`,children:[e.jsx("td",{className:"table-td",children:t.id}),e.jsx("td",{className:"table-td",children:t.user_id}),e.jsx("td",{className:"table-td",children:t.device_type||"-"}),e.jsx("td",{className:"table-td",children:t.token?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{title:t.token,children:[t.token.slice(0,25),"..."]}),e.jsxs("button",{onClick:()=>S(t.token,t.id),className:"text-blue-500 hover:scale-110 transition text-sm",children:[d.bool&&t.id===d.id&&e.jsx(ne,{size:20}),d.id!==t.id&&e.jsx(G,{size:20})]})]}):"-"}),e.jsx("td",{className:"table-td",children:t.user.name||"-"}),e.jsx("td",{className:"table-td",children:t.user.email||"-"}),e.jsx("td",{className:"table-td",children:t.user.prefix||""}),e.jsx("td",{className:"table-td",children:t.user.points||"-"}),e.jsx("td",{className:"table-td",children:t.user.wallet||"-"}),e.jsx("td",{className:"table-td",children:t.notifications_channel_id||"-"}),e.jsx("td",{className:"table-td",children:k(t.user.email_verified_at)||"-"}),e.jsx("td",{className:"table-td",children:t.notifications_channel_id||"-"}),e.jsx("td",{className:"table-td",children:k(t.last_used_at)}),e.jsx("td",{className:"table-td",children:k(t.created_at)}),e.jsx("td",{className:"table-td",children:k(t.updated_at)}),e.jsx("td",{className:"table-td",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{onClick:()=>C(t),size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"}),e.jsx(W,{onClick:()=>{u(!0),p(t.id)},size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"}),e.jsx(Q,{onClick:()=>{p(t.id),j(!0)},size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"})]})})]},r))})]})})]})},O=[{label:"ID"},{label:"User ID"},{label:"Device Type"},{label:"Token"},{label:"User Name"},{label:"User Email"},{label:"User Prefix"},{label:"User Points"},{label:"User Wallet"},{label:"User Notifications Channel ID"},{label:"User Email Verified At"},{label:"Last Used At"},{label:"Created At"},{label:"Updated At"}],me=()=>{const[c,n]=a.useState([]),[m,h]=a.useState({}),[o,i]=a.useState(1),[x,u]=a.useState(""),[g,p]=a.useState(""),[f,y]=a.useState(!1),[N,j]=a.useState(!1),[d,v]=a.useState({id:"",name:"",email:""}),[S,_]=a.useState(""),[C,t]=a.useState([]),[r,b]=a.useState(!0),[P,I]=a.useState(!1),[T,E]=a.useState(1),[U,z]=a.useState(""),[D,L]=a.useState(""),A=a.useRef(null);a.useEffect(()=>{const s=setTimeout(()=>{L(U)},350);return()=>{clearTimeout(s)}},[U]),a.useEffect(()=>{const s=setTimeout(()=>{p(x)},350);return()=>{clearTimeout(s)}},[x]),a.useEffect(()=>{E(1),t([]),b(!0)},[D]),a.useEffect(()=>{(async()=>{try{j(!0);const l=await ie(11,o,d.id,S,g);n(l.data.items||[]),h(l.data.pagination||{})}catch(l){console.log(l)}finally{j(!1)}})()},[o,f,g,d.id]),a.useEffect(()=>{(async()=>{if(r)try{I(!0);const l=await se(10,T,D),w=l.data.items||[];w.length===0&&b(!1),T>=l.data.pagination.totalPages&&b(!1),t(F=>[...F,...w.map(K=>({id:K.id,name:K.name}))])}catch(l){console.log(l)}finally{I(!1)}})()},[T,D]);const R=()=>{r&&E(s=>s+1)};return e.jsx("div",{children:e.jsxs(X,{noborder:!0,children:[e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-100 dark:border-[var(--border-secondary)]",children:[e.jsx("h1",{className:"md:text-2xl text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Device Tokens Management"}),e.jsx("p",{className:"md:text-base text-[14px] text-gray-500 dark:text-gray-400 mt-1",children:"Filter, search, and manage available device tokens"})]}),e.jsx("div",{className:"flex w-full md:items-center sm:items-end items-center mb-8 md:flex-row flex-col",children:e.jsx("div",{className:"flex items-center gap-2 flex-1 md:flex-row flex-col md:w-auto w-full",children:e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"clientName",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Users"}),e.jsx(Y,{searchKeySelect:U,onInputChange:s=>z(s),onChange:s=>v(s),onEndReached:R,options:C,value:d.name,isLoading:P,optionBoxRef:A,noResultMessage:"No result"})]})})}),e.jsx("div",{className:"h-px w-full bg-gray-100 dark:bg-[var(--border-secondary)] my-3 mb-4"}),e.jsxs("div",{className:"flex justify-between w-full mb-5",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:x,onChange:s=>u(s.target.value),className:"w-full pl-9 pr-3 py-2 text-sm rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)] bg-gray-50/50 dark:bg-[var(--surface-elevated)] text-gray-700 dark:text-slate-200 placeholder-gray-400 dark:placeholder-slate-500 outline-none focus:border-indigo-300 dark:focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/10 transition-all"}),e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-slate-500 w-4 h-4"})]})}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-3.5 py-2 text-sm font-medium rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)] bg-white dark:bg-[var(--surface-elevated)] text-gray-600 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-[var(--surface-hover)] transition-colors flex-shrink-0",children:[e.jsx("span",{className:"sm:block hidden",children:"Export"}),e.jsx(ee,{size:20})]})]}),N?e.jsx(te,{columns:O,rows:12}):e.jsx(de,{columns:O,deviceTokensRows:c,setDeviceTokensRows:n,refetch:f,setRefetch:y}),e.jsx("div",{className:"my-4 w-full flex justify-center",children:e.jsx(ae,{onPageChange:i,pagination:m,isLoading:N})})]})})};export{me as default};
