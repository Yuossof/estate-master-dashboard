import{r as a,j as e,o as $,p as q,q as P,s as H,X as G,t as W,U as A,v as X,B as R,E as F,w as Y,L as J,S as Q,T as Z,x as ee,C as ae,i as se,y as re,F as te,z as le,G as ne,k as oe}from"./index-DSdmN7-O.js";import{a as de,d as ie,g as ce}from"./company-users-88HzjCM-.js";const me=({name:n,limit:o=15})=>{const[i,u]=a.useState(!1);if(!n)return null;const p=n.length>o,s=!i&&p?n.slice(0,o)+"...":n;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:s}),p&&!i&&e.jsx("button",{onClick:()=>u(!0),className:"text-blue-400 underline text-sm cursor-pointer",children:"more"})]})},xe=({isOpen:n,setIsDrawerOpen:o,onClose:i,userId:u})=>{const[p]=$(),[s,c]=a.useState({}),[v,b]=a.useState(!1),[t,f]=a.useState({});a.useEffect(()=>{if(!u)return;const d=new AbortController;return(async()=>{try{b(!0);const m=await de(u,d.signal);console.log(m.data),c(m.data.user),f(m.data.company)}catch(m){console.log(m)}finally{b(!1)}})(),()=>d.abort()},[u]),a.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]);const y=d=>{navigator.clipboard.writeText(d)};return e.jsx(q,{children:n&&e.jsxs("div",{onClick:()=>o(!1),className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-end z-[1000]",children:[e.jsx("div",{className:"absolute inset-0",onClick:i}),e.jsx(P.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{duration:.3,ease:[.4,0,.2,1]},className:"relative h-full w-full max-w-[600px] bg-white dark:bg-[var(--surface-elevated)] shadow-2xl",onClick:d=>d.stopPropagation(),children:e.jsx(H,{isDark:p,className:"bg-transparent w-full !mx-0 !px-0 h-full",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 dark:hover:bg-[var(--surface-hover)] rounded-full transition-colors absolute dark:-top-5 top-3 right-4",children:e.jsx(G,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),e.jsx("div",{className:"overflow-y-auto h-full pb-20",children:v?e.jsxs("div",{className:"flex flex-col justify-center items-center h-96 space-y-4",children:[e.jsx(P.div,{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full",animate:{rotate:360},transition:{repeat:Number.POSITIVE_INFINITY,duration:1,ease:"linear"}}),e.jsx(W,{})]}):e.jsxs("div",{className:"px-6 py-6 space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-5 mb-4 border-b border-gray-100 dark:border-[var(--border-primary)]",children:[e.jsx(A,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"User Information"})]}),e.jsxs("div",{className:"flex items-start gap-4 py-4 dark:py-4 dark:px-3.5 bg-gray-50 dark:bg-[var(--surface-card)] rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gradient-to-br from-blue-100 to-blue-200 flex-shrink-0",children:s.profile_image?e.jsx("img",{src:s.profile_image||"/placeholder.svg",alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center w-full h-full",children:e.jsx(A,{className:"w-8 h-8 text-blue-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 truncate",children:s.name||"No name provided"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:s.email||"No email provided"}),s.role&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:s.role})]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(h,{label:"User ID",value:s.id}),e.jsx(h,{label:"Wallet",value:s.wallet}),e.jsx(h,{label:"Points Balance",value:s.points?`${s.points} pts`:"0 pts"}),e.jsx(h,{label:"Prefix",value:s.prefix||"Not set"}),e.jsxs("div",{className:"p-4 bg-white dark:bg-[var(--surface-card)] border border-gray-200 dark:border-[var(--border-primary)] rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Device Token"}),s.device_token&&e.jsx("button",{onClick:()=>y(s.device_token),className:"p-1 hover:bg-gray-100 dark:hover:bg-[var(--surface-hover)] rounded transition-colors",title:"Copy to clipboard",children:e.jsx(X,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-mono break-all",children:s.device_token||"No device token"})]}),e.jsx(h,{label:"Notification Channel",value:s.notifications_channel_id||"Not configured"}),e.jsx(h,{label:"Email Verification",value:s.email_verified_at?"Verified":"Not verified",status:s.email_verified_at?"success":"warning"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-100 dark:border-[var(--border-primary)]",children:[e.jsx(R,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Company Information"})]}),e.jsxs("div",{className:"flex items-start gap-4 py-4 dark:py-4 dark:px-3.5 bg-gray-50 dark:bg-[var(--surface-card)] rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden bg-gradient-to-br from-green-100 to-green-200 flex-shrink-0",children:t.logo?e.jsx("img",{src:t.logo||"/placeholder.svg",alt:t.name,className:"w-full h-full object-contain p-2"}):e.jsx("div",{className:"flex items-center justify-center w-full h-full",children:e.jsx(R,{className:"w-8 h-8 text-green-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.name||"Company name not available"}),t.name_ar&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.name_ar})]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(h,{label:"Company ID",value:t.id|"Not specified"}),e.jsx(h,{label:"Application Name",value:t.app_name||"Not specified"}),t.description&&e.jsxs("div",{className:"p-4 bg-white dark:bg-[var(--surface-card)] border border-gray-200 dark:border-[var(--border-primary)] rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Description"}),e.jsx(F,{text:t.description,limit:150,className:"text-sm text-gray-600 dark:text-gray-400 leading-relaxed"})]}),t.description_ar&&e.jsxs("div",{className:"p-4 bg-white dark:bg-[var(--surface-card)] border border-gray-200 dark:border-[var(--border-primary)] rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Arabic Description"}),e.jsx(F,{text:t.description_ar,limit:150,className:"text-sm text-gray-600 dark:text-gray-400 leading-relaxed"})]})]})]})]})})]})})})]})})},h=({label:n,value:o,status:i})=>e.jsx("div",{className:"p-4 bg-white dark:bg-[var(--surface-card)] border border-gray-200 dark:border-[var(--border-primary)] rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-100 font-medium",children:o}),i==="success"&&e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),i==="warning"&&e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"})]})]})}),ge=({columns:n,companyUsersRows:o=[],setCommpanyUsersRows:i,setRefetch:u,refetch:p})=>{const[s,c]=a.useState(!1),[v,b]=a.useState(!1),[t,f]=a.useState(null),[y,d]=a.useState(""),[k,m]=a.useState(!1),[E,D]=a.useState("en"),w=()=>{D(r=>r==="en"?"ar":"en")},C=async()=>{new FormData().append("company_id",y);try{m(!0);const x=await ie(t);c(!1);const j=o.filter(N=>N.id!==t);i(j),j.length===0&&u(!p),console.log(x)}catch(x){console.log(x)}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(xe,{setIsDrawerOpen:b,isOpen:v,onClose:()=>b(!1),userId:t}),e.jsx(Y,{onConfirm:C,onCancel:()=>c(!1),isOpen:s,message:"Are you sure you want to delete this item?",confirmText:"Delete",cancelText:"Cancel",isLoading:k}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)]",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsx("tr",{children:n.map((r,x)=>e.jsx("th",{scope:"col",className:"table-th",children:e.jsxs("div",{className:"flex items-center justify-between",children:[r.label,r.label==="Description"&&e.jsx("div",{onClick:w,className:`bg-slate-100 \r
                                                        border-[1px] border-slate-200 w-8 h-8\r
                                                        cursor-pointer hover:shadow-lg hover:scale-110\r
                                                        active:-rotate-45 shadow-md rounded-full flex \r
                                                        justify-center items-center transition-all duration-300`,children:e.jsx(J,{className:"dark:text-gray-300 text-gray-600",size:19})})]})},x))})}),e.jsx("tbody",{className:"bg-white dark:bg-transparent divide-y divide-gray-100 dark:divide-[var(--border-secondary)]",children:o.length>0&&o.map((r,x)=>e.jsxs("tr",{className:`align-top ${x%2!==0?"bg-gray-50/50 dark:bg-[var(--surface-elevated)]/30":"bg-white dark:bg-transparent"}`,children:[e.jsx("td",{className:"table-td",children:r.id}),e.jsx("td",{className:"table-td",children:e.jsx(me,{name:r.user.name,limit:70})}),e.jsx("td",{className:"table-td",children:r.user.email}),e.jsx("td",{className:"table-td",children:r.company.name}),e.jsx("td",{className:"table-td",children:r.company.name_ar}),e.jsx("td",{className:"table-td",children:r.company.app_name}),e.jsx("td",{className:"table-td",children:r.company.logo?e.jsx("img",{src:r.company.logo[0],alt:`${r.company.name} logo`,className:"w-10 h-10 object-contain cursor-pointer hover:scale-110 transition-all active:scale-100  rounded-md border border-gray-200 dark:border-[var(--border-primary)]"}):e.jsx("span",{className:"text-gray-400 italic",children:"No logo"})}),e.jsx("td",{className:"table-td",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"}),e.jsx(Z,{onClick:()=>{c(!0),f(r.id)},size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"}),e.jsx(ee,{onClick:()=>{f(r.id),d(r.company.id),b(!0)},size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"})]})})]},x))})]})})]})},K=[{label:"ID"},{label:"Name"},{label:"Email"},{label:"Company Name"},{label:"Company Name Arabic"},{label:"App Name "},{label:"Logo"},{label:"Action"}],be=()=>{const[n,o]=a.useState([]),[i,u]=a.useState({}),[p,s]=a.useState(1),[c,v]=a.useState(""),[b,t]=a.useState(!1),[f,y]=a.useState(!1),[d,k]=a.useState({name:"",id:""}),[m,E]=a.useState(""),[D,w]=a.useState([]),[C,r]=a.useState(!0),[x,j]=a.useState(!1),[N,z]=a.useState(""),[U,B]=a.useState(""),[_,T]=a.useState(1),S=a.useRef(null);a.useEffect(()=>{const l=setTimeout(()=>{B(N)},350);return()=>{clearTimeout(l)}},[N]),a.useEffect(()=>{const l=setTimeout(()=>{E(c)},350);return()=>{clearTimeout(l)}},[c]),a.useEffect(()=>{const l=new AbortController;return(async()=>{try{y(!0);const g=await ce(9,p,c,d.id,l.signal);o(g.data.items||[]),u(g.data.pagination||{})}catch(g){console.log(g)}finally{y(!1)}})(),()=>l.abort()},[p,b,m,d.id]),a.useEffect(()=>{const l=new AbortController;return(async()=>{if(C)try{j(!0);const g=await oe(11,_,U,l.signal);console.log(g);const I=g.data.items||[];I.length===0&&r(!1),_>=g.data.pagination.totalPages&&r(!1),w(V=>[...V,...I.map(L=>({id:L.id,name:L.name}))])}catch(g){console.log(g)}finally{j(!1),S.current&&(S.current.scrollTop=S.current.scrollHeight)}})(),()=>l.abort()},[_,U]),a.useEffect(()=>{T(1),w([]),r(!0)},[U]),a.useEffect(()=>{s(1)},[d]);const M=()=>{C&&T(l=>l+1)};return e.jsx("div",{children:e.jsxs(ae,{noborder:!0,children:[e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-100 dark:border-[var(--border-secondary)]",children:[e.jsx("h1",{className:"md:text-2xl text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Company Users Management"}),e.jsx("p",{className:"md:text-base text-[15px] text-gray-500 dark:text-gray-400 mt-1",children:"Browse, search, and manage registered company users"})]}),e.jsxs("div",{className:"flex items-center w-full flex-col",children:[e.jsx("div",{className:"flex w-full md:items-center sm:items-end items-center mb-8 md:flex-row flex-col",children:e.jsx("div",{className:"flex items-center gap-2 flex-1 md:flex-row flex-col md:w-auto w-full",children:e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"clientName",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Company"}),e.jsx(se,{searchKeySelect:N,onInputChange:l=>z(l),onChange:l=>k(l),onEndReached:M,options:D,value:d.name,isLoading:x,optionBoxRef:S,noResultMessage:"No result"})]})})}),e.jsx("div",{className:"h-px w-full bg-gray-100 dark:bg-[var(--border-secondary)] my-3 mb-4"}),e.jsxs("div",{className:"flex justify-between w-full mb-4",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:c,onChange:l=>v(l.target.value),className:"w-full pl-9 pr-3 py-2 text-sm rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)] bg-gray-50/50 dark:bg-[var(--surface-elevated)] text-gray-700 dark:text-slate-200 placeholder-gray-400 dark:placeholder-slate-500 outline-none focus:border-indigo-300 dark:focus:border-indigo-500/50 focus:ring-2 focus:ring-indigo-500/10 transition-all"}),e.jsx(re,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-slate-500 w-4 h-4"})]})}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-3.5 py-2 text-sm font-medium rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)] bg-white dark:bg-[var(--surface-elevated)] text-gray-600 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-[var(--surface-hover)] transition-colors flex-shrink-0",children:[e.jsx("span",{className:"sm:block hidden",children:"Export"}),e.jsx(te,{size:20})]})]})]}),f?e.jsx(le,{columns:K,rows:14}):e.jsx(ge,{columns:K,companyUsersRows:n,setCompanyUsersRows:o,refetch:b,setRefetch:t}),e.jsx("div",{className:"my-4 w-full flex justify-center",children:e.jsx(ne,{onPageChange:s,pagination:i,isLoading:f})})]})})};export{be as default};
