import{O as S,r as a,j as e,q as C,w as P,L as T,S as D,T as L,R,H as U,J as A,K as E,C as I,i as F,y as z,F as K,z as _,G as $}from"./index-DSdmN7-O.js";import{P as k}from"./DateRangePicker-DfMR9tZE.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]],q=S("list-filter",O),H=({text:r,limit:n=150,expanded:l,onToggle:u})=>{if(!r)return null;const[i,m]=a.useState("auto"),c=a.useRef(null),x=a.useRef(null);if(!r)return null;const h=r.length>n,g=r.slice(0,n)+(h?"...":"");return a.useEffect(()=>{const d=l?c.current:x.current;d&&m(d.scrollHeight)},[l,r]),e.jsxs("div",{className:"relative",children:[e.jsxs(C.div,{animate:{height:i},transition:{duration:.4,ease:"easeInOut"},className:"break-words whitespace-pre-line text-gray-600 dark:text-gray-300 max-w-[500px] min-w-[300px] overflow-hidden",children:[e.jsx("div",{ref:x,style:{display:l?"none":"block"},children:g}),e.jsx("div",{ref:c,style:{display:l?"block":"none"},children:r})]}),h&&e.jsx("button",{onClick:u,className:"text-blue-500 underline ml-1 cursor-pointer",children:l?"less":"more"})]})},M=({columns:r,userRows:n=[],setUserRows:l,setRefetch:u,refetch:i})=>{const[m,c]=a.useState(!1),[x,h]=a.useState(null),[g,d]=a.useState(!1),[p,y]=a.useState("en"),[j,f]=a.useState(null),N=()=>{y(s=>s==="en"?"ar":"en")},v=async()=>{try{d(!0);const s=await R(x);c(!1);const o=n.filter(t=>t.id!==x);l(o),o.length===0&&u(!i),console.log(s)}catch(s){console.log(s)}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{onConfirm:v,onCancel:()=>c(!1),isOpen:m,message:"Are you sure you want to delete this item?",confirmText:"Delete",cancelText:"Cancel",isLoading:g}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)]",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsx("tr",{children:r.map((s,o)=>e.jsx("th",{scope:"col",className:"table-th",children:e.jsxs("div",{className:"flex items-center justify-between",children:[s.label,s.label==="Description"&&e.jsx("div",{onClick:N,className:`bg-slate-100 \r
                                                        border-[1px] border-slate-200 w-8 h-8\r
                                                        cursor-pointer hover:shadow-lg hover:scale-110\r
                                                        active:-rotate-45 shadow-md rounded-full flex \r
                                                        justify-center items-center transition-all duration-300`,children:e.jsx(T,{className:"dark:text-gray-300 text-gray-600",size:19})})]})},o))})}),e.jsx("tbody",{className:"bg-white dark:bg-transparent divide-y divide-gray-100 dark:divide-[var(--border-secondary)]",children:n.length>0&&n.map((s,o)=>e.jsxs("tr",{className:`align-top ${o%2!==0?"bg-gray-50/50 dark:bg-[var(--surface-elevated)]/30":"bg-white dark:bg-transparent"}`,children:[e.jsx("td",{className:"table-td",children:s.user?.id}),e.jsx("td",{className:"table-td",children:s.user?.name}),e.jsx("td",{className:"table-td",children:s.user?.email}),e.jsx("td",{className:"table-td",children:s.points}),e.jsx("td",{className:"table-td",children:s.user.wallet}),s.description&&e.jsx("td",{className:"table-td border border-gray-200 transition-all dark:bg-[var(--surface-card)] dark:border-[var(--border-primary)]",children:e.jsx(H,{text:p==="en"?s.description:s.description_ar,limit:200,expanded:j===s.id,onToggle:()=>f(j===s.id?null:s.id)})}),e.jsx("td",{className:"table-td",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"}),e.jsx(L,{onClick:()=>{c(!0),h(s.id)},size:20,className:"dark:text-gray-400 text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 cursor-pointer"})]})})]},o))})]})})]})},B=async(r,n,l,u)=>{try{const i=U("token");return i?(await A.get(`/api/dashboard/points?user_id=${l}&per_page=${r}&page=${n}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},signal:u})).data:void 0}catch(i){E(i)}},w=[{label:"ID"},{label:"User Name"},{label:"User Email"},{label:"Points"},{label:"Wallet"},{label:"Description"},{label:"Action"}],W=()=>{const[r,n]=a.useState(null),[l,u]=a.useState(null),[i,m]=a.useState([]),[c,x]=a.useState({}),[h,g]=a.useState(1),[d,p]=a.useState(!1),[y,j]=a.useState(!1),[f,N]=a.useState(""),[v,s]=a.useState(f);a.useEffect(()=>{const t=setTimeout(()=>{s(f)},500);return()=>{clearTimeout(t)}},[f]),a.useEffect(()=>{const t=new AbortController;return(async()=>{try{p(!0);const b=await B(11,h,v,t.signal);console.log("points",b),m(b.data.items),x(b.data.pagination)}catch(b){console.log(b)}finally{p(!1)}})(),()=>t.abort()},[h,y,v]);const o=t=>{N(t.target.value)};return e.jsx("div",{className:"",children:e.jsxs(I,{noborder:!0,children:[e.jsxs("div",{className:"flex items-center w-full flex-col",children:[e.jsxs("div",{className:"flex w-full md:items-center sm:items-end items-center mb-8 md:flex-row flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 md:flex-row flex-col md:w-auto w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"clientName",className:"px-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Company"}),e.jsx(F,{value:"Select Company"})]}),e.jsx(k,{onChange:t=>n(t),value:r,label:"From Date"}),e.jsx(k,{onChange:t=>u(t),value:l,label:"To Date"})]}),e.jsxs("button",{className:"btn-primary justify-center flex items-center gap-3 mt-8 py-1.5 px-2 rounded-md sm:ml-3 ml-0 sm:w-auto w-full",children:[e.jsx("span",{children:"Filter"}),e.jsx(q,{})]})]}),e.jsx("div",{className:"h-px w-full bg-gray-100 dark:bg-[var(--border-secondary)] my-4"}),e.jsxs("div",{className:"flex justify-between w-full mb-4",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden",children:e.jsxs("div",{className:"relative w-full overflow-hidden",children:[e.jsx("input",{type:"text",onChange:o,placeholder:"Search...",className:"border dark:border-[var(--border-primary)] text-md border-gray-200  py-1.5 dark:bg-[var(--surface-elevated)] px-2 pr-9 rounded-md w-full outline-none"}),e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-slate-500 w-4 h-4"})]})}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-3.5 py-2 text-sm font-medium rounded-lg border border-gray-200/80 dark:border-[var(--border-primary)] bg-white dark:bg-[var(--surface-elevated)] text-gray-600 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-[var(--surface-hover)] transition-colors flex-shrink-0",children:[e.jsx("span",{className:"sm:block hidden",children:"Export"}),e.jsx(K,{size:20})]})]})]}),e.jsx("div",{className:"overflow-x-auto ",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:d?e.jsx(_,{columns:w,rows:11}):e.jsx(M,{columns:w,userRows:i,setUserRows:m,refetch:y,setRefetch:j})})}),e.jsx("div",{className:"my-4 w-full flex justify-center",children:e.jsx("div",{className:"flex items-center gap-2 mt-6",children:e.jsx($,{isLoading:d,onPageChange:t=>g(t),pagination:c})})})]})})};export{W as default};
